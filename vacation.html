<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vuetify 2 Calendar - Year View</title>
    <!-- Vuetify CSS -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <style>
        /* Styling for the year view */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f5f5f5;
        }
        #app {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .v-toolbar__title {
            font-weight: 400;
        }
        .month-title {
            font-size: 1rem;
            font-weight: 500;
            text-align: center;
        }

        /* Make the day cell the positioning context */
        .v-calendar-monthly__day {
            position: relative;
        }

        /* The overlay that provides the background and holds the controls */
        .toggled-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(76, 175, 80, 0.3);
            display: flex;
            justify-content: center;
            align-items: flex-end; /* Push controls to the bottom */
            padding-bottom: 4px;
            z-index: 1; /* Sit on top of the cell, but below the number */
        }

        /* The container for the buttons inside the overlay */
        .day-controls {
            display: flex;
            gap: 4px;
        }

        /* Ensure the day number is always on top of our overlay */
        .v-calendar-monthly__day-label {
            position: relative;
            z-index: 2;
        }
    </style>
</head>
<body>
    <div id="app">
        <v-app>
            <v-main>
                <v-container fluid>
                    <!-- Main Toolbar for Year Navigation -->
                    <v-sheet class="rounded-lg mb-4" elevation="1">
                        <v-toolbar flat class="rounded-lg">
                            <v-btn fab text small color="grey darken-2" @click="prevYear">
                                <v-icon small>mdi-chevron-left</v-icon>
                            </v-btn>
                            <v-btn fab text small color="grey darken-2" @click="nextYear">
                                <v-icon small>mdi-chevron-right</v-icon>
                            </v-btn>
                            <v-toolbar-title class="ml-4">
                                {{ year }}
                            </v-toolbar-title>
                            <v-spacer></v-spacer>
                            <v-btn outlined color="grey darken-2" @click="setToday">
                                Today
                            </v-btn>
                        </v-toolbar>
                    </v-sheet>

                    <!-- Grid of 12 Monthly Calendars -->
                    <v-row>
                        <v-col v-for="month in 12" :key="month" cols="12" sm="6" md="4" lg="3">
                            <v-sheet class="rounded-lg" elevation="1">
                                <!-- Month Title -->
                                <v-toolbar flat dense color="transparent">
                                    <v-toolbar-title class="month-title flex-grow-1 text-center">{{ getMonthName(month) }}</v-toolbar-title>
                                </v-toolbar>
                                <v-divider></v-divider>
                                
                                <!-- Calendar Component -->
                                <v-calendar
                                    :ref="'calendar-' + month"
                                    :start="getMonthDate(month)"
                                    type="month"
                                    color="primary"
                                    @click:date="toggleDay"
                                >
                                    <!-- Use the day-body slot to inject content below the day number -->
                                    <template v-slot:day-body="{ date, outside }">
                                        <div class="toggled-overlay" v-if="!outside && isToggled(date)">
                                            <div class="day-controls">
                                                <v-btn fab x-small color="success" @click.stop="approveDay(date)">
                                                    <v-icon x-small>mdi-check</v-icon>
                                                </v-btn>
                                                <v-btn fab x-small color="error" @click.stop="disapproveDay(date)">
                                                    <v-icon x-small>mdi-close</v-icon>
                                                </v-btn>
                                            </div>
                                        </div>
                                    </template>
                                </v-calendar>
                            </v-sheet>
                        </v-col>
                    </v-row>

                </v-container>
            </v-main>
        </v-app>
    </div>

    <!-- Vue and Vuetify JS -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script>
        new Vue({
            el: '#app',
            vuetify: new Vuetify(),
            data: () => ({
                year: new Date().getFullYear(),
                toggledDays: new Set(), // To store 'YYYY-MM-DD' strings of "On" days
            }),
            watch: {
                // When year changes, clear the selected days
                year() {
                    this.toggledDays.clear();
                    // Force a re-render
                    this.toggledDays = new Set(this.toggledDays);
                }
            },
            methods: {
                // Set the view to the current year
                setToday () {
                    this.year = new Date().getFullYear();
                },
                // Go to the previous year
                prevYear () {
                    this.year--;
                },
                // Go to the next year
                nextYear () {
                    this.year++;
                },
                // Get the start date string for a given month (1-12)
                getMonthDate(month) {
                    return `${this.year}-${String(month).padStart(2, '0')}-01`;
                },
                // Get the month name for a given month number (1-12)
                getMonthName(month) {
                    const date = new Date(this.year, month - 1, 1);
                    return date.toLocaleString('default', { month: 'long' });
                },
                // Check if a day is toggled "On"
                isToggled(date) {
                    return this.toggledDays.has(date);
                },
                // Toggles a day's state between "On" and "Off"
                toggleDay({ date }) {
                    if (this.toggledDays.has(date)) {
                        this.toggledDays.delete(date);
                    } else {
                        this.toggledDays.add(date);
                    }
                    // Force Vue to react to the change in the Set by creating a new one
                    this.toggledDays = new Set(this.toggledDays);
                },
                // Placeholder function for approving a day
                approveDay(date) {
                    console.log(`Approved: ${date}`);
                    // You could change the state here, e.g., remove it from toggledDays
                },
                // Placeholder function for disapproving a day
                disapproveDay(date) {
                    console.log(`Disapproved: ${date}`);
                    // You could change the state here, e.g., remove it from toggledDays
                },
            },
        });
    </script>
</body>
</html>
